(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):e.tplify=t()})(this,function(){function e(e,n){n=n||{};var u=['var tpl = "";'];var p=t(e);for(var i=0,a=p.length;i<a;i++){var o=p[i];if(!o.type){var c='tpl+="'+o.txt.replace(/{{=(.*?)}}/g,function(e,t){return'"+'+t+'+"'}).replace(/{{(.*?)}}/g,function(e,t){return'"+_e('+t+')+"'})+'"';u.push(c)}else{u.push(o.txt)}}u.push("return tpl;");return new Function("data","_e",u.join("\n"))(n,r)}function t(e){var t=[];var r=/<%(?!=)([\s\S]*?)%>/g;var u;var p=0;while(u=r.exec(e)){n(t,e.substring(p,u.index));t.push({type:1,txt:u[1]});p=u.index+u[0].length}n(t,e.substr(p));return t}function n(e,t){t=t.replace(/\r?\n/g,"\\n");e.push({txt:t})}function r(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")}return e});